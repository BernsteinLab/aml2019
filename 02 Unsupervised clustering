# 	Initial QC yielded 7,698 cells from normal BM donors. We randomly filtered 783 cells of 1,590 BM5 CD34+CD38â€“ cells to reduce representation of this population. The remaining 6,915 normal BM cells were then clustered into cell types using BackSPIN (Zeisel et al., 2015). BackSPIN employs a bi-clustering algorithm which iteratively splits both cells and genes, until a predetermined number of splits is reached. We selected the BackSPIN algorithm because it performs well when dealing with a relatively large number of cell populations. This is especially true for datasets in which some clusters are demarcated by a large number of differentially expressed genes (e.g. between the myeloid and lymphoid lineages), and others by relatively few genes (e.g. different populations within the myeloid lineage).
# For clustering, we first determined the most variably expressed genes in the dataset. We performed a linear fit of the log-transformed average expression values and the log-transformed coefficients of variation (standard deviation divided by the average expression). Variably expressed genes were determined as genes associated with a residual larger than two times the standard deviation of all residuals. From these genes we excluded a set of genes that were associated with cell cycle (ASPM, CENPE, CENPF, DLGAP5, MKI67, NUSAP1, PCLAF, STMN1, TOP2A, TUBB). This yielded in the order of 1,000 to 2,000 variably expressed genes depending on the set of cells (Figure S1C, S4A). Expression values were log-transformed (after addition of 1) before performing BackSPIN clustering. We used default settings and a maximum splitting depth of 5. In the healthy BM data this yielded a final set of 31 clusters.
# In a first post-processing step we calculated the average expression level of each gene for each cluster. If gene expression of a single cell correlated higher to the average gene expression of another cluster than the cluster it was part of, we reassigned the cell to the cluster it was most highly correlated to. For the healthy BM data, we merged clusters if their average gene expression profiles were highly correlated and if they were characterized by similar cell type-specific marker genes. This yielded 15 cell types across the undifferentiated compartment and the three main lineages (erythroid, lymphoid, and myeloid, Figure 1A).

# Code to be provided
